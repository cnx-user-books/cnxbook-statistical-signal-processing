<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:md="http://cnx.rice.edu/mdml">
  <title>Kalman Filters</title>
  <metadata><md:content-id>undefined</md:content-id><md:title/><md:uuid>c9893f54-a434-495f-974a-1993d41a9c41</md:uuid>
</metadata>

  <content>
    <para id="para1">The Kalman filter is an important generalization
      of the Wiener filter. Unlike Wiener filters, which are designed
      under the assumption that the signal and noise are
      <emphasis>stationary</emphasis>, the Kalman filter has the ability
      to <emphasis>adapt</emphasis> itself to non-stationary
      environments.  
    </para>

    <para id="para2">The Kalman filter can be viewed as a
      <emphasis>sequential</emphasis> minimum MSE estimator of a
      signal in additive noise. If the signal and noise are jointly
      Gaussian, the then Kalman filter is optimal in a minimum MSE
      sense (minimizes expected quadratic loss).
    </para>

    <para id="para3">If the signal and/or noise are non-Gaussian, then
      the Kalman filter is the best linear estimator (linear estimator that
      minimizes MSE among all possible linear estimators).
    </para>

    <section id="dsm">
      <title>Dynamical Signal Models</title>
      <para id="para1a">Recall the simple DC signal estimation problem.
	<equation id="eqn1">
	  <m:math>
	    <m:apply>
	      <m:forall/>
	      <m:bvar>
		<m:ci>n</m:ci>
	      </m:bvar>
	      <m:condition>
		<m:apply>
		  <m:eq/>
		  <m:ci>n</m:ci>
		  <m:set>
		    <m:cn>0</m:cn>
		    <m:ci>…</m:ci>
		    <m:apply>
		      <m:minus/>
		      <m:ci>N</m:ci>
		      <m:cn>1</m:cn>
		    </m:apply>
		  </m:set>
		</m:apply>
	      </m:condition>
	      <m:apply>
		<m:eq/>
		<m:ci><m:msub>
		    <m:mi>x</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:apply>
		  <m:plus/>
		  <m:ci>A</m:ci>
		  <m:ci><m:msub>
		      <m:mi>w</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	Where <m:math><m:ci>A</m:ci></m:math> is the unknown DC level and 
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>w</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> is the white Gaussian
	noise. <m:math><m:ci>A</m:ci></m:math> could represent the
	voltage of a DC power supply. We know how to find several good
	estimators of <m:math><m:ci>A</m:ci></m:math> given the
	measurements
	<m:math>
	  <m:set>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mn>0</m:mn>
	      </m:msub></m:ci>
	    <m:ci>…</m:ci>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mrow>
		  <m:mi>N</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:set>
	</m:math>.
      </para>

      <para id="para2a">In practical situations this model may be too
	simplistic. the load on the power supply may charge over time
	and there will be other variations due to temperature and
	component aging.
      </para>

      <para id="para3a">To account for these variations we can employ a
	more accurate measurement model:
	<equation id="eqn2">
	  <m:math>
	    <m:apply>
	      <m:forall/>
	      <m:bvar>
		<m:ci>n</m:ci>
	      </m:bvar>
	      <m:condition>
		<m:apply>
		  <m:eq/>
		  <m:ci>n</m:ci>
		  <m:set>
		    <m:cn>0</m:cn>
		    <m:ci>…</m:ci>
		    <m:apply>
		      <m:minus/>
		      <m:ci>N</m:ci>
		      <m:cn>1</m:cn>
		    </m:apply>
		  </m:set>
		</m:apply>
	      </m:condition>
	      <m:apply>
		<m:eq/>
		<m:ci><m:msub>
		    <m:mi>x</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:apply>
		  <m:plus/>
		  <m:ci><m:msub>
		      <m:mi>A</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>w</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	where the voltage
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>A</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> is the <emphasis>true</emphasis> voltage at time
	<m:math><m:ci>n</m:ci></m:math>.
      </para>

      <para id="para4">Now the estimation problem is significantly more
	complicated since we must estimate
	<m:math>
	  <m:set>
	    <m:ci><m:msub>
		<m:mi>A</m:mi>
		<m:mn>0</m:mn>
	      </m:msub></m:ci>
	    <m:ci>…</m:ci>
	    <m:ci><m:msub>
		<m:mi>A</m:mi>
		<m:mrow>
		  <m:mi>N</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:set>
	</m:math>. Suppose that the true voltage
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>A</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> does not vary too rapidly over time. Then successive
	samples of
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>A</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> will not be too different, suggesting that the voltage
	signal displays a high degree of <term>correlation</term>.
      </para>

      <para id="para5">This reasoning suggests that it may be reasonable
	to regard the sequence
	<m:math>
	  <m:set>
	    <m:ci><m:msub>
		<m:mi>A</m:mi>
		<m:mn>0</m:mn>
	      </m:msub></m:ci>
	    <m:ci>…</m:ci>
	    <m:ci><m:msub>
		<m:mi>A</m:mi>
		<m:mrow>
		  <m:mi>N</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:set>
	</m:math>, as a realization of a correlated (not white) random
	process. Adopting a random process model for
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>A</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> allows us to pursue a Bayesian approach to the
	estimation problem (<link target-id="fig1"/>).

	<figure id="fig1">
	  <title>Voltage Varying Over Time</title>
	  <media id="idp5670960" alt=""><image src="../../media/voltVary.png" mime-type="image/png"/></media>
	</figure>

	Using the model in <link target-id="eqn2"/>, it is easy to verify
	that the maximum likelihood and MVUB esitmators are given by
	<equation id="eqn3">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci><m:msub>
		    <m:mi>A</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	      <m:ci><m:msub>
		  <m:mi>x</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	    </m:apply>
	  </m:math>
	</equation>
	Our estimate is simply the noisy measurements! No averaging
	takes place, so there is no noise reduction.
      </para>

      <para id="para6">Let's look at the example again, <link target-id="fig2"/>.
	
	<figure id="fig2">
	  <title>True Voltage Varying Over Time</title>
	  <media id="idp461392" alt=""><image src="../../media/voltActual.png" mime-type="image/png"/></media>
	</figure>

	The voltage
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>A</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> is varying about an average value of 10V. Assume this
	average value is known and write
	<equation id="eqn4">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci><m:msub>
		  <m:mi>A</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	      <m:apply>
		<m:plus/>
		<m:cn>10</m:cn>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	Where
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci> 
	</m:math> is a zero-mean random process. Now a simple model for
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci> 
	</m:math> 
	which allows us to specify the correlation between samples is
	the <term>first-order Gauss-Markov</term> prcoess model:
	<equation id="eqn5">
	  <m:math>
	    <m:apply>
	      <m:forall/>
	      <m:bvar>
		<m:ci>n</m:ci>
	      </m:bvar>
	      <m:condition>
		<m:apply>
		  <m:eq/>
		  <m:ci>n</m:ci>
		  <m:set>
		    <m:cn>1</m:cn>
		    <m:cn>2</m:cn>
		    <m:ci>…</m:ci>
		  </m:set>
		</m:apply>
	      </m:condition>
	      <m:apply>
		<m:eq/>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:apply>
		  <m:plus/>
		  <m:apply>
		    <m:times/>
		    <m:ci>a</m:ci>
		    <m:ci><m:msub>
			<m:mi>y</m:mi>
		      <m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub></m:ci>
		  </m:apply>
		  <m:ci><m:msub>
		      <m:mi>u</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	Where
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci><m:msub>
		<m:mi>u</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:cn>0</m:cn>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>u</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math> iid (white Gaussian noise process). To initialize the
	process we take
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>y</m:mi>
	      <m:mn>0</m:mn>
	    </m:msub></m:ci>
	</m:math> to be the realization of a Gaussian random variable:
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci><m:msub>
		<m:mi>y</m:mi>
		<m:mn>0</m:mn>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:cn>0</m:cn>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>y</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>.
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>u</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> is called the <term>driving</term> or
	<term>excitation</term> noise. The model in <link target-id="eqn5"/> is called the <term>dynamical</term> or
	<term>state</term> model. The current output
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> depends only on the <emphasis>state</emphasis> of the
	system at the previous time, or
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>y</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub></m:ci>
	</m:math>, and the current input
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>u</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> (<link target-id="fig3"/>).

	<figure id="fig3">
	  <media id="idm1267584" alt=""><image src="../../media/dynamicalModel.png" mime-type="image/png"/></media>
	</figure>

	<m:math display="block">
	  <m:apply>
	    <m:eq/>
	    <m:ci><m:msub>
		<m:mi>y</m:mi>
		<m:mn>1</m:mn>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:ci>a</m:ci>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mn>0</m:mn>
		  </m:msub></m:ci>
	      </m:apply>
	      <m:ci><m:msub>
		  <m:mi>u</m:mi>
		  <m:mn>0</m:mn>
		</m:msub></m:ci>
	    </m:apply>
	  </m:apply>
	</m:math>

	<equation id="eqn6">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci><m:msub>
		  <m:mi>y</m:mi>
		  <m:mn>2</m:mn>
		</m:msub></m:ci>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:ci>a</m:ci>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mn>1</m:mn>
		    </m:msub></m:ci>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>u</m:mi>
		    <m:mn>1</m:mn>
		  </m:msub></m:ci>
	      </m:apply>

	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:ci>a</m:ci>
		  <m:apply>
		    <m:plus/>
		    <m:apply>
		      <m:times/>
		      <m:ci>a</m:ci>
		      <m:ci><m:msub>
			  <m:mi>y</m:mi>
			  <m:mn>0</m:mn>
			</m:msub></m:ci>
		    </m:apply>
		    <m:ci><m:msub>
			<m:mi>u</m:mi>
			<m:mn>0</m:mn>
		      </m:msub></m:ci>
		  </m:apply>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>u</m:mi>
		    <m:mn>1</m:mn>
		  </m:msub></m:ci>
	      </m:apply>

	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mn>0</m:mn>
		    </m:msub></m:ci>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:ci>a</m:ci>
		  <m:ci><m:msub>
		      <m:mi>u</m:mi>
		      <m:mn>1</m:mn>
		    </m:msub></m:ci>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>u</m:mi>
		    <m:mn>2</m:mn>
		  </m:msub></m:ci>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>

	<m:math display="block">
	  <m:ci>⋮</m:ci>
	</m:math>

	<m:math display="block">
	  <m:apply>
	    <m:eq/>
	    <m:ci><m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:power/>
		  <m:ci>a</m:ci>
		  <m:apply>
		    <m:plus/>
		    <m:ci>n</m:ci>
		    <m:cn>1</m:cn>
		  </m:apply>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mn>0</m:mn>
		  </m:msub></m:ci>
	      </m:apply>
	      <m:apply>
		<m:sum/>
		<m:bvar>
		  <m:ci>k</m:ci>
		</m:bvar>
		<m:lowlimit>
		  <m:cn>1</m:cn>
		</m:lowlimit>
		<m:uplimit>
		  <m:ci>n</m:ci>
		</m:uplimit>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:ci>k</m:ci>
		  </m:apply>
		  <m:ci><m:msub>
		      <m:mi>u</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mi>k</m:mi>
		      </m:mrow>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>

	<equation id="eqn7">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:apply>
		      <m:plus/>
		      <m:ci>n</m:ci>
		      <m:cn>1</m:cn>
		    </m:apply>
		  </m:apply>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		    <m:ci><m:msub>
			<m:mi>y</m:mi>
			<m:mn>0</m:mn>
		      </m:msub></m:ci>
		  </m:apply>
		</m:apply>
		<m:apply>
		  <m:sum/>
		  <m:bvar>
		    <m:ci>k</m:ci>
		  </m:bvar>
		  <m:lowlimit>
		    <m:cn>1</m:cn>
		  </m:lowlimit>
		  <m:uplimit>
		    <m:ci>n</m:ci>
		  </m:uplimit>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:power/>
		      <m:ci>a</m:ci>
		      <m:ci>k</m:ci>
		    </m:apply>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		      <m:ci><m:msub>
			  <m:mi>u</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mi>k</m:mi>
			  </m:mrow>
			</m:msub></m:ci>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	      <m:cn>0</m:cn>
	    </m:apply>
	  </m:math>
	</equation>
	Correlation:
	<equation id="eqn8">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>m</m:mi>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:plus/>
		    <m:apply>
		      <m:times/>
		      <m:apply>
			<m:power/>
			<m:ci>a</m:ci>
			<m:apply>
			  <m:plus/>
			  <m:ci>m</m:ci>
			  <m:cn>1</m:cn>
			</m:apply>
		      </m:apply>
		      <m:ci><m:msub>
			  <m:mi>y</m:mi>
			  <m:mn>0</m:mn>
			</m:msub></m:ci>
		    </m:apply>
		    <m:apply>
		      <m:sum/>
		      <m:bvar>
			<m:ci>k</m:ci>
		      </m:bvar>
		      <m:lowlimit>
			<m:cn>1</m:cn>
		      </m:lowlimit>
		      <m:uplimit>
			<m:ci>m</m:ci>
		      </m:uplimit>
		      <m:apply>
			<m:times/>
			<m:apply>
			  <m:power/>
			  <m:ci>a</m:ci>
			  <m:ci>k</m:ci>
			</m:apply>
			<m:ci><m:msub>
			    <m:mi>u</m:mi>
			    <m:mrow>
			      <m:mi>m</m:mi>
			      <m:mo>-</m:mo>
			      <m:mi>k</m:mi>
			    </m:mrow>
			  </m:msub></m:ci>
		      </m:apply>
		    </m:apply>
		  </m:apply>
		  <m:apply>
		    <m:plus/>
		    <m:apply>
		      <m:times/>
		      <m:apply>
			<m:power/>
			<m:ci>a</m:ci>
			<m:apply>
			  <m:plus/>
			  <m:ci>n</m:ci>
			  <m:cn>1</m:cn>
			</m:apply>
		      </m:apply>
		      <m:ci><m:msub>
			  <m:mi>y</m:mi>
			  <m:mn>0</m:mn>
			</m:msub></m:ci>
		    </m:apply>
		    <m:apply>
		      <m:sum/>
		      <m:bvar>
			<m:ci>l</m:ci>
		      </m:bvar>
		      <m:lowlimit>
			<m:cn>1</m:cn>
		      </m:lowlimit>
		      <m:uplimit>
			<m:ci>n</m:ci>
		      </m:uplimit>
		      <m:apply>
			<m:times/>
			<m:apply>
			  <m:power/>
			  <m:ci>a</m:ci>
			  <m:ci>l</m:ci>
			</m:apply>
			<m:ci><m:msub>
			    <m:mi>u</m:mi>
			    <m:mrow>
			      <m:mi>n</m:mi>
			      <m:mo>-</m:mo>
			      <m:mi>l</m:mi>
			    </m:mrow>
			  </m:msub></m:ci>
		      </m:apply>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>

	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:power/>
		      <m:ci>a</m:ci>
		      <m:apply>
			<m:plus/>
			<m:ci>m</m:ci>
			<m:ci>n</m:ci>
			<m:cn>2</m:cn>
		      </m:apply>
		    </m:apply>
		    <m:apply>
		      <m:power/>
		      <m:ci><m:msub>
			  <m:mi>y</m:mi>
			  <m:mn>0</m:mn>
			</m:msub></m:ci>
		      <m:cn>2</m:cn>
		    </m:apply>
		  </m:apply>
		</m:apply>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		  <m:apply>
		    <m:sum/>
		    <m:bvar>
		      <m:ci>k</m:ci>
		    </m:bvar>
		    <m:lowlimit>
		      <m:cn>1</m:cn>
		    </m:lowlimit>
		    <m:uplimit>
		      <m:ci>m</m:ci>
		    </m:uplimit>
		    <m:apply>
		      <m:sum/>
		      <m:bvar>
			<m:ci>l</m:ci>
		      </m:bvar>
		      <m:lowlimit>
			<m:cn>1</m:cn>
		      </m:lowlimit>
		      <m:uplimit>
			<m:ci>n</m:ci>
		      </m:uplimit>
		      <m:apply>
			<m:times/>
			<m:apply>
			  <m:power/>
			  <m:ci>a</m:ci>
			  <m:apply>
			    <m:plus/>
			    <m:ci>k</m:ci>
			    <m:ci>l</m:ci>
			  </m:apply>
			</m:apply>
			<m:ci><m:msub>
			    <m:mi>u</m:mi>
			    <m:mrow>
			      <m:mi>m</m:mi>
			      <m:mo>-</m:mo>
			      <m:mi>k</m:mi>
			    </m:mrow>
			  </m:msub></m:ci>
			<m:ci><m:msub>
			    <m:mi>u</m:mi>
			    <m:mrow>
			      <m:mi>n</m:mi>
			      <m:mo>-</m:mo>
			      <m:mi>l</m:mi>
			    </m:mrow>
			  </m:msub></m:ci>
		      </m:apply>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>

	<equation id="eqn9">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>u</m:mi>
		      <m:mrow>
			<m:mi>m</m:mi>
			<m:mo>-</m:mo>
			<m:mi>k</m:mi>
		      </m:mrow>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>u</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mi>l</m:mi>
		      </m:mrow>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	      <m:piecewise>
		<m:piece>
		  <m:apply>
		    <m:power/>
		    <m:ci><m:msub>
			<m:mi>σ</m:mi>
			<m:mi>n</m:mi>
		      </m:msub></m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		  <m:apply>
		    <m:eq/>
		    <m:apply>
		      <m:minus/>
		      <m:ci>m</m:ci>
		      <m:ci>k</m:ci>
		    </m:apply>
		    <m:apply>
		      <m:minus/>
		      <m:ci>n</m:ci>
		      <m:ci>l</m:ci>
		    </m:apply>
		  </m:apply>
		</m:piece>
		<m:otherwise>
		  <m:cn>0</m:cn>
		</m:otherwise>
	      </m:piecewise>
	    </m:apply>
	  </m:math>
	</equation>

	If 
	<m:math>
	  <m:apply>
	    <m:gt/>
	    <m:ci>m</m:ci>
	    <m:ci>n</m:ci>
	  </m:apply>
	</m:math>, then
	<equation id="eqn10">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>m</m:mi>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:apply>
		      <m:plus/>
		      <m:ci>m</m:ci>
		      <m:ci>n</m:ci>
		      <m:cn>2</m:cn>
		    </m:apply>
		  </m:apply>
		  <m:apply>
		    <m:power/>
		    <m:ci><m:msub>
			<m:mi>σ</m:mi>
			<m:mi>y</m:mi>
		      </m:msub></m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:apply>
		      <m:minus/>
		      <m:ci>m</m:ci>
		      <m:ci>n</m:ci>
		    </m:apply>
		  </m:apply>
		  <m:apply>
		    <m:power/>
		    <m:ci><m:msub>
			<m:mi>σ</m:mi>
			<m:mi>u</m:mi>
		      </m:msub></m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		  <m:apply>
		    <m:sum/>
		    <m:bvar>
		      <m:ci>k</m:ci>
		    </m:bvar>
		    <m:lowlimit>
		      <m:cn>1</m:cn>
		    </m:lowlimit>
		    <m:uplimit>
		      <m:ci>n</m:ci>
		    </m:uplimit>
		    <m:apply>
		      <m:power/>
		      <m:ci>a</m:ci>
		      <m:apply>
			<m:times/>
			<m:cn>2</m:cn>
			<m:ci>k</m:ci>
		      </m:apply>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	If 
	<m:math>
	  <m:apply>
	    <m:gt/>
	    <m:apply>
	      <m:abs/>
	      <m:ci>a</m:ci>
	    </m:apply>
	    <m:cn>1</m:cn>
	  </m:apply>
	</m:math>, then it's obvious that the process diverges (<m:math>
	  <m:apply>
	    <m:tendsto/>
	    <m:mtext>variance</m:mtext>
	    <m:infinity/>
	  </m:apply>
	</m:math>). This is equivalent to having a pole outside the unit
	circle shown in <link target-id="fig4"/>.

	<figure id="fig4">
	  <media id="idp7178656" alt=""><image src="../../media/unitCircle.png" mime-type="image/png"/></media>
	</figure>

	So, let's assume
	<m:math>
	  <m:apply>
	    <m:lt/>
	    <m:apply>
	      <m:abs/>
	      <m:ci>a</m:ci>
	    </m:apply>
	    <m:cn>1</m:cn>
	  </m:apply>
	</m:math> and hence a stable system. Thus as
	<m:math><m:ci>m</m:ci></m:math> and
	<m:math><m:ci>n</m:ci></m:math> get large
	<m:math display="block">
	  <m:apply>
	    <m:tendsto/>
	    <m:apply>
	      <m:times/>
	      <m:apply>
		<m:power/>
		<m:ci>a</m:ci>
		<m:apply>
		  <m:plus/>
		  <m:ci>m</m:ci>
		  <m:ci>n</m:ci>
		  <m:cn>2</m:cn>
		</m:apply>
	      </m:apply>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>y</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	    <m:cn>0</m:cn>
	  </m:apply>
	</m:math>
	Now let 
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:minus/>
	      <m:ci>m</m:ci>
	      <m:ci>n</m:ci>
	    </m:apply>
	    <m:ci>τ</m:ci>
	  </m:apply>
	</m:math>. Then for <m:math><m:ci>m</m:ci></m:math> and
	<m:math><m:ci>n</m:ci></m:math> large we have

	<equation id="eqn11">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>m</m:mi>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:power/>
		  <m:ci>a</m:ci>
		  <m:ci>τ</m:ci>
		</m:apply>
		<m:apply>
		  <m:power/>
		  <m:ci><m:msub>
		      <m:mi>σ</m:mi>
		      <m:mi>u</m:mi>
		    </m:msub></m:ci>
		  <m:cn>2</m:cn>
		</m:apply>
		<m:apply>
		  <m:sum/>
		  <m:bvar>
		    <m:ci>k</m:ci>
		  </m:bvar>
		  <m:lowlimit>
		    <m:cn>1</m:cn>
		  </m:lowlimit>
		  <m:uplimit>
		    <m:ci>n</m:ci>
		  </m:uplimit>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:apply>
		      <m:times/>
		      <m:cn>2</m:cn>
		      <m:ci>k</m:ci>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	      
	      <m:apply>
		<m:divide/>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:apply>
		      <m:plus/>
		      <m:ci>τ</m:ci>
		      <m:cn>2</m:cn>
		    </m:apply>
		  </m:apply>
		  <m:apply>
		    <m:power/>
		    <m:ci><m:msub>
			<m:mi>σ</m:mi>
			<m:mi>u</m:mi>
		      </m:msub></m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		</m:apply>
		<m:apply>
		  <m:minus/>
		  <m:cn>1</m:cn>
		  <m:apply>
		    <m:power/>
		    <m:ci>a</m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	This shows us how correlated the process is:
	<m:math display="block">
	  <m:apply>
	    <m:implies/>
	    <m:apply>
	      <m:tendsto/>
	      <m:apply>
		<m:abs/>
		<m:ci>a</m:ci>
	      </m:apply>
	      <m:cn>1</m:cn>
	    </m:apply>
	    <m:mtext>heavily correlated (or anticorrelated)</m:mtext>
	  </m:apply>
	</m:math>
	<m:math display="block">
	  <m:apply>
	    <m:implies/>
	    <m:apply>
	      <m:tendsto/>
	      <m:apply>
		<m:abs/>
		<m:ci>a</m:ci>
	      </m:apply>
	      <m:cn>0</m:cn>
	    </m:apply>
	    <m:mtext>weakly correlated</m:mtext>
	  </m:apply>
	</m:math>
      </para>

      <para id="paranext">
	How can we use this model to help us in our estimation problem?
      </para>
    </section>

    <section id="theKF">
      <title>The Kalman Filter</title>
      <para id="para1c">Let's look at a more general formulation of the
	problem at hand. Suppose that we have a vector-valued dynamical
	equation
	<equation id="eqn12">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:apply>
		    <m:plus/>
		    <m:mi>n</m:mi>
		    <m:mn>1</m:mn>
		  </m:apply>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:ci type="vector">A</m:ci>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:ci type="vector">b</m:ci>
		  <m:ci><m:msub>
		      <m:mi>u</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	Where
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> is
	<m:math>
	  <m:apply>
	    <m:cartesianproduct/>
	    <m:ci>p</m:ci>
	    <m:cn>1</m:cn>
	  </m:apply>
	</m:math>
	dimensional,
	<m:math>
	  <m:ci type="vector">A</m:ci>
	</m:math> is
	<m:math>
	  <m:apply>
	    <m:cartesianproduct/>
	    <m:ci>p</m:ci>
	    <m:ci>p</m:ci>
	  </m:apply>
	</m:math>,
	and
	<m:math>
	  <m:ci type="vector">b</m:ci>
	</m:math> is
	<m:math> 
	  <m:apply>
	    <m:cartesianproduct/>
	    <m:ci>p</m:ci>
	    <m:cn>1</m:cn>
	  </m:apply>
	</m:math>.
	The initial <emphasis>state vector</emphasis> is
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>Y</m:mi>
		<m:mn>0</m:mn>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:ci type="vector">0</m:ci>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>R</m:mi>
		  <m:mn>0</m:mn>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:apply>
	</m:math>, where
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>R</m:mi>
	      <m:mn>0</m:mn>
	    </m:msub>
	  </m:ci>
	</m:math> is the covariance matrix and
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci><m:msub>
		<m:mi>u</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:cn>0</m:cn>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>u</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math> iid (white Gaussian <emphasis>excitation</emphasis> noise).
	This reduces to the case we just looked at when
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci>p</m:ci>
	    <m:cn>1</m:cn>
	  </m:apply>
	</m:math>. This model could represent a
	<m:math>
	  <m:msup>
	    <m:mi>p</m:mi>
	    <m:mi>th</m:mi>
	  </m:msup>
	</m:math> order Gauss-Markov process:
	<equation id="eqn13">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci><m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub></m:ci>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>a</m:mi>
		      <m:mn>1</m:mn>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>a</m:mi>
		      <m:mn>2</m:mn>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub></m:ci>
		</m:apply>
		<m:ci>…</m:ci>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>a</m:mi>
		      <m:mi>p</m:mi>
		    </m:msub></m:ci>
		  <m:ci><m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mi>p</m:mi>
			<m:mo>+</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub></m:ci>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>u</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>

	Define
	<equation id="eqn14">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci type="vector">
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:ci>
	      <m:vector>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mi>p</m:mi>
		      <m:mo>+</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub></m:ci>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mi>p</m:mi>
		      <m:mo>+</m:mo>
		      <m:mn>2</m:mn>
		    </m:mrow>
		  </m:msub></m:ci>
		<m:ci>⋮</m:ci>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub></m:ci>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:vector>
	    </m:apply>
	  </m:math>
	</equation>
	Then, 
	<equation id="eqn15">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:apply>
		    <m:plus/>
		    <m:mi>n</m:mi>
		    <m:mn>1</m:mn>
		  </m:apply>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:ci type="vector">A</m:ci>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:ci type="vector">b</m:ci>
		  <m:msub>
		    <m:mi>u</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:apply>
	      </m:apply>
	      
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:matrix>
		    <m:matrixrow>
		      <m:cn>0</m:cn>
		      <m:cn>1</m:cn>
		      <m:cn>0</m:cn>
		      <m:ci>…</m:ci>
		      <m:ci>…</m:ci>
		      <m:cn>0</m:cn>
		    </m:matrixrow>
		    <m:matrixrow>
		      <m:cn>0</m:cn>
		      <m:cn>0</m:cn>
		      <m:cn>1</m:cn>
		      <m:cn>0</m:cn>
		      <m:ci>…</m:ci>
		      <m:cn>0</m:cn>
		    </m:matrixrow>
		    <m:matrixrow>
		      <m:ci>⋮</m:ci>
		      <m:ci>⋮</m:ci>
		      <m:ci>⋱</m:ci>
		      <m:ci>⋱</m:ci>
		      <m:ci>⋱</m:ci>
		      <m:ci>⋮</m:ci>
		    </m:matrixrow>
		    <m:matrixrow>
		      <m:ci>⋮</m:ci>
		      <m:ci>⋮</m:ci>
		      <m:ci>⋱</m:ci>
		      <m:ci>⋱</m:ci>
		      <m:ci>⋱</m:ci>
		      <m:cn>0</m:cn>
		    </m:matrixrow>
		    <m:matrixrow>
		      <m:cn>0</m:cn>
		      <m:cn>0</m:cn>
		      <m:ci>…</m:ci>
		      <m:ci>…</m:ci>
		      <m:cn>0</m:cn>
		      <m:cn>1</m:cn>
		    </m:matrixrow>
		    <m:matrixrow>
		      <m:ci><m:msub>
			  <m:mi>a</m:mi>
			  <m:mn>1</m:mn>
			</m:msub></m:ci>
		      <m:ci><m:msub>
			  <m:mi>a</m:mi>
			  <m:mn>2</m:mn>
			</m:msub></m:ci>
		      <m:ci>…</m:ci>
		      <m:ci>…</m:ci>
		      <m:ci><m:msub>
			  <m:mi>a</m:mi>
			  <m:mrow>
			    <m:mi>p</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub></m:ci>
		      <m:ci><m:msub>
			  <m:mi>a</m:mi>
			  <m:mi>p</m:mi>
			</m:msub></m:ci>
		    </m:matrixrow>
		  </m:matrix>
		  <m:vector>
		    <m:ci><m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mi>p</m:mi>
			  <m:mo>+</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub></m:ci>
		    <m:ci><m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mi>p</m:mi>
			  <m:mo>+</m:mo>
			  <m:mn>2</m:mn>
			</m:mrow>
		      </m:msub></m:ci>
		    <m:ci>⋮</m:ci>
		    <m:ci>⋮</m:ci>
		    <m:ci><m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub></m:ci>
		    <m:ci><m:msub>
			<m:mi>y</m:mi>
			<m:mi>n</m:mi>
		      </m:msub></m:ci>
		  </m:vector>
		</m:apply>
		<m:vector>
		  <m:cn>0</m:cn>
		  <m:ci>⋮</m:ci>
		  <m:ci>⋮</m:ci>
		  <m:ci>⋮</m:ci>
		  <m:cn>0</m:cn>
		  <m:cn>1</m:cn>
		</m:vector>
		<m:ci><m:msub>
		    <m:mi>u</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	Here 
	<m:math>
	  <m:ci type="vector">A</m:ci>
	</m:math> is the <term>state transition matrix</term>. Since 
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> is a linear combination of Gaussian vectors:
	<equation id="eqn16">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci type="vector">A</m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mn>0</m:mn>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:apply>
		  <m:sum/>
		  <m:bvar>
		    <m:ci>k</m:ci>
		  </m:bvar>
		  <m:lowlimit>
		    <m:cn>1</m:cn>
		  </m:lowlimit>
		  <m:uplimit>
		    <m:ci>n</m:ci>
		  </m:uplimit>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:power/>
		      <m:ci type="vector">A</m:ci>
		      <m:apply>
			<m:minus/>
			<m:ci>k</m:ci>
			<m:cn>1</m:cn>
		      </m:apply>
		    </m:apply>
		    <m:ci type="vector">b</m:ci>
		    <m:ci><m:msub>
			<m:mi>u</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mi>k</m:mi>
			</m:mrow>
		      </m:msub></m:ci>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>

	We know that
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> is also Gaussian distributed with mean <!-- there is a
	blank in the notes --> and covariance
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>R</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
	      <m:apply>
		<m:times/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>,
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>Y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:cn type="vector"><!-- there is another blank space
		here --></m:cn>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>R</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:apply>
	</m:math>. The covariance can be recursively computed from the
	basic state equation:
	<equation id="eqn17">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>R</m:mi>
		  <m:apply>
		    <m:plus/>
		    <m:mi>n</m:mi>
		    <m:mn>1</m:mn>
		  </m:apply>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:ci type="vector">A</m:ci>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>R</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		  <m:apply>
		    <m:transpose/>
		    <m:ci type="vector">A</m:ci>
		  </m:apply>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:power/>
		    <m:ci><m:msub>
			<m:mi>σ</m:mi>
			<m:mi>u</m:mi>
		      </m:msub></m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		  <m:ci type="vector">b</m:ci>
		  <m:apply>
		    <m:transpose/>
		    <m:ci type="vector">b</m:ci>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>

	Assume that measurements of the state are available:
	<equation id="eqn18">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci><m:msub>
		  <m:mi>x</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	      <m:apply>
		<m:plus/>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:transpose/>
		    <m:ci type="vector">C</m:ci>
		  </m:apply>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>w</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	
	Where
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci><m:msub>
		<m:mi>w</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:cn>0</m:cn>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>w</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math> iid independant of 
	<m:math>
	  <m:set>
	    <m:ci><m:msub>
		<m:mi>u</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	  </m:set>
	</m:math> (white Gaussian <emphasis>observation</emphasis> noise).
      </para>

      <para id="para2c">For example, if
	<m:math display="inline">
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">C</m:ci>
	    <m:vector>
	      <m:cn>0</m:cn>
	      <m:ci>…</m:ci>
	      <m:cn>0</m:cn>
	      <m:cn>1</m:cn>
	    </m:vector>
	  </m:apply>
	</m:math>, then
	<equation id="eqn19">
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci><m:msub>
		  <m:mi>x</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	      <m:apply>
		<m:plus/>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:ci><m:msub>
		    <m:mi>w</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	    </m:apply>
	  </m:math>
	</equation>
	Where 
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>x</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> is the observation, 
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> is the signal, and
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>w</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> is the noise. Since our model for the signal is
	Gaussian as well as the observation noise, it follows that
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:cn>0</m:cn>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>,
	where
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:power/>
	      <m:ci><m:msub>
		  <m:mi>σ</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	      <m:cn>2</m:cn>
	    </m:apply>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>R</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:ci type="vector">C</m:ci>
	      </m:apply>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>w</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math> (<link target-id="fig5"/>).

	<figure id="fig5">   
	  <title>Block Diagram</title>
	  <media id="idm1582096" alt=""><image src="../../media/block.png" mime-type="image/png"/></media>
	</figure>
      </para>

      <para id="para3c">Kalman first posed the problem of estimating the
	state of
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> from the sequence of measurements
	<m:math display="block">
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:vector>
	      <m:ci><m:msub>
		  <m:mi>x</m:mi>
		  <m:mn>0</m:mn>
		</m:msub></m:ci>
	      <m:ci>⋮</m:ci>
	      <m:ci><m:msub>
		  <m:mi>x</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	    </m:vector>
	  </m:apply>
	</m:math> 
	To derive the Kalman filter we will call upon the Gauss-Markov
	Theorem.
      </para>

      <para id="para4c">First note that the conditional distribution of
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math>
	given
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>x</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> is Gaussian:
	<m:math display="block">
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:mrow>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	      <m:mo>|</m:mo>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>x</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	    </m:mrow>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector"><m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		    </m:mrow>
		  </m:msub></m:ci>
	      </m:apply>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>P</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:apply>
	</m:math>
	Where 
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector"><m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:apply>
	</m:math> is the conditional mean and
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>P</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:math> is the covariance.
      </para>

      <para id="para5c">We <emphasis>know</emphasis> that this is the
	<emphasis>form</emphasis> of the conditional distribution because 
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> and
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>x</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> are <emphasis>jointly</emphasis> Gaussian
	distributed. 
	<note id="idm42272">
	  <m:math display="block">
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	      <m:mrow>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:mo>|</m:mo>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>x</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
	      </m:mrow>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector"><m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
		      </m:mrow>
		    </m:msub></m:ci>
		</m:apply>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	    </m:apply>
	  </m:math>
	  where
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	  </m:math> is the signal samples
	  <m:math>
	    <m:mrow>
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	      <m:mo>,</m:mo>
	      <m:mi>…</m:mi>
	      <m:mo>,</m:mo>
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mi>p</m:mi>
		  <m:mo>+</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:mrow>
	  </m:math>,
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	  </m:math> is the observations/measurements
	  <m:math>
	    <m:mrow>
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	      <m:mo>,</m:mo>
	      <m:mi>…</m:mi>
	      <m:mo>,</m:mo>
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mi>p</m:mi>
		  <m:mo>+</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:mrow>
	  </m:math>, and 
	  <m:math>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector"><m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		  </m:mrow>
		</m:msub></m:ci>
	    </m:apply>
	  </m:math> is the best (minimum MSE) estimator of
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	  </m:math> given
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	  </m:math>.
	</note>
	This is all well and good, but we need to know what
	the conditional mean and covariance are explicitly. So the
	problem is now to find/compute
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector"><m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:apply>
	</m:math> and 
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>P</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:math>. We can take advantage of the recursive state equation
	to obtain a recursive procedure for this calculation. To begin,
	consider the "predictor"
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector"><m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:apply>
	</m:math>:
	<m:math display="block">
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:mrow>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	      <m:mo>|</m:mo>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>x</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:mrow>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector"><m:msub>		  
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub></m:ci>
	      </m:apply>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>P</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:apply>
	</m:math>
	Where
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> is the signal samples, 
	<m:math>
	  <m:set>
	    <m:ci><m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:ci>…</m:ci>
	    <m:ci><m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mi>p</m:mi>
		  <m:mo>+</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:set>
	</m:math>, 
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>x</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:math> is the observations
	<m:math>
	  <m:set>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	    <m:ci>…</m:ci>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mi>p</m:mi>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:set>
	</m:math>, and 
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector"><m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:apply>
	</m:math> is the best min MSE estimator of
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:math> given
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>x</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:math>. Although we don't know what forms 
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector"><m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	  </m:apply>
	</m:math> and
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>P</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:math> have, we do know two important facts:
      </para>
    </section>

    <para id="para6c">
      <list id="pred" list-type="enumerated">
	<item>The predictor
	  <m:math>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector"><m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub></m:ci>
	    </m:apply>
	  </m:math> acts as a sufficient statistic for
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	  </m:math>. That is, we can replace
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:math> (the data) with
	  <m:math>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector"><m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub></m:ci>
	    </m:apply>
	  </m:math> (the predictor). In other words, all the 
	  relevant information in
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:math> pertaining to 
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	  </m:math> is summarized by the predictor
	  <m:math>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:math>, which is, of course, a function of 
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>x</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:math>.
	</item>
    
	<item>
	  The predictor
	  <m:math>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:math> and the prediction error
	  <m:math>
	    <m:apply>
	      <m:eq/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>e</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:minus/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:math> are orthogonal (the <term>orthogonality
	    principle</term> of minimum MSE estimators
	  <m:math>
	    <m:apply>
	      <m:implies/>
	    </m:apply>
	  </m:math>
	  <m:math>
	    <m:apply>
	      <m:implies/>
	      <m:apply>
		<m:eq/>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>y</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		    <m:apply>
		      <m:transpose/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>e</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		  </m:apply>
		</m:apply>
		<m:cn>0</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:math> error is orthogonal to estimator).
	</item>
      </list>

      Moreover, 
      <equation id="eqn20">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>e</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      Since all quantities are zero-mean,
      <m:math display="block">
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>e</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	    <m:ci type="vector">0</m:ci>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>P</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:apply>
	</m:apply>
      </m:math>
      where
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>P</m:mi>
	    <m:mrow>
	      <m:mi>n</m:mi>
	      <m:mo>|</m:mo>
	      <m:mi>n</m:mi>
	      <m:mo>-</m:mo>
	      <m:mn>1</m:mn>
	    </m:mrow>
	  </m:msub>
	</m:ci>
      </m:math> is the covariance of 
      <m:math>
	<m:mrow>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	  <m:mo>|</m:mo>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>x</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:mrow>
      </m:math> and "variability" of
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>y</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub>
	</m:ci>
      </m:math> about the predictor
      <m:math>
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:apply>
      </m:math>. Therefore, 
      <m:math display="block">
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:apply>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	    <m:ci type="vector">0</m:ci>
	    <m:apply>
	      <m:minus/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>R</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>P</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:apply>
	</m:apply>
      </m:math>
      Where 
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>R</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub>
	</m:ci>
      </m:math>
      is the covariance of
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>Y</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub>
	</m:ci>
      </m:math>. Now suppose that we have the predictor
      <m:math>
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:apply>
      </m:math> computed and a new measurement is made:
      <equation id="eqn21">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
	      </m:apply>
	      <m:ci><m:msub>
		  <m:mi>w</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	    </m:apply>
	    
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
		<m:apply>
		  <m:plus/>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>e</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
	      </m:apply>
	      <m:ci><m:msub>
		  <m:mi>w</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      
      <note type="Note" id="idp13169872"><label>Note</label>
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:apply>
	</m:math>,
	<m:math>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>e</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:math>, and
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>w</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	</m:math> are all <emphasis>orthogonal</emphasis>.</note>
    </para>
    

    <para id="para9">We can express all relevant quantities in the
      matrix equation
      <equation id="eqn22">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:vector>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	      <m:ci><m:msub>
		  <m:mi>x</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	    </m:vector>
	    <m:apply>
	      <m:times/>
	      <m:matrix>
		<m:matrixrow>
		  <m:ci type="vector">I</m:ci>
		  <m:ci type="vector">I</m:ci>
		  <m:cn>0</m:cn>
		</m:matrixrow>
		<m:matrixrow>
		  <m:ci type="vector">0</m:ci>
		  <m:ci type="vector">I</m:ci>
		  <m:cn>0</m:cn>
		</m:matrixrow>
		<m:matrixrow>
		  <m:apply>
		    <m:transpose/>
		    <m:ci type="vector">C</m:ci>
		  </m:apply>
		  <m:apply>
		    <m:transpose/>
		    <m:ci type="vector">C</m:ci>
		  </m:apply>
		  <m:cn>1</m:cn>
		</m:matrixrow>
	      </m:matrix>
	      <m:vector>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>e</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>w</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:vector>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      Now because of the orthogonality, the covariance
      <equation id="eqn23">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
	      <m:apply>
		<m:times/>
		<m:vector>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>e</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		  <m:ci><m:msub>
		      <m:mi>w</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:vector>
		<m:apply>
		  <m:transpose/>
		  <m:vector>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>e</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>y</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		    <m:ci><m:msub>
			<m:mi>w</m:mi>
			<m:mi>n</m:mi>
		      </m:msub></m:ci>
		  </m:vector>
		</m:apply>
	      </m:apply>
	    </m:apply>

	    <m:matrix>
	      <m:matrixrow>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>		
		<m:ci type="vector">0</m:ci>
		<m:cn>0</m:cn>
	      </m:matrixrow>
	      <m:matrixrow>
		<m:ci type="vector">0</m:ci>
		<m:apply>
		  <m:minus/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>R</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>		
		</m:apply>
		<m:cn>0</m:cn>
	      </m:matrixrow>
	      <m:matrixrow>
		<m:ci type="vector">0</m:ci>
		<m:ci type="vector">0</m:ci>
		<m:apply>
		  <m:power/>
		  <m:ci><m:msub>
		      <m:mi>σ</m:mi>
		      <m:mi>w</m:mi>
		    </m:msub></m:ci>
		  <m:cn>2</m:cn>
		</m:apply>
	      </m:matrixrow>
	    </m:matrix>
	  </m:apply>
	</m:math>
      </equation>
      Combining this with the matrix <link target-id="eqn22"/> shows that
      <equation id="eqn24">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
	      <m:apply>
		<m:times/>
		<m:vector>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		  <m:ci><m:msub>
		      <m:mi>x</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:vector>
		<m:apply>
		  <m:transpose/>
		  <m:vector>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mi>n</m:mi>
		      </m:msub>
		    </m:ci>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>y</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		    <m:ci><m:msub>
			<m:mi>x</m:mi>
			<m:mi>n</m:mi>
		      </m:msub></m:ci>
		  </m:vector>
		</m:apply>
	      </m:apply>
	    </m:apply>

	    <m:matrix>
	      <m:matrixrow>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>R</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>R</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
	      </m:matrixrow>
	      <m:matrixrow>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:ci>⋮</m:ci>
		<m:ci>…</m:ci>
	      </m:matrixrow>
	      <m:matrixrow>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:transpose/>
		    <m:ci type="vector">C</m:ci>
		  </m:apply>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>R</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:ci>⋮</m:ci>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>S</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
	      </m:matrixrow>
	    </m:matrix>
	  </m:apply>
	</m:math>
      </equation>
      <note type="Key" id="idm1301408"><label>Key</label>
	<m:math display="inline">
	  <m:vector>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	  </m:vector>
	</m:math> are jointly Gaussian with the covariance in <link target-id="eqn24"/> and means zero.</note>
      Where
      <equation id="eqn25">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>P</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:apply>
	      <m:minus/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>R</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>

      <equation id="eqn26">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>S</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:matrix>
	      <m:matrixrow>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>P</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
	      </m:matrixrow>
	      <m:matrixrow>
		<m:apply>
		  <m:times/>
		  <m:apply>
		    <m:transpose/>
		    <m:ci type="vector">C</m:ci>
		  </m:apply>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>P</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		</m:apply>
		<m:apply>
		  <m:power/>
		  <m:ci><m:msub>
		      <m:mi>σ</m:mi>
		      <m:mi>w</m:mi>
		    </m:msub></m:ci>
		  <m:cn>2</m:cn>
		</m:apply>
	      </m:matrixrow>
	    </m:matrix>
	  </m:apply>
	</m:math>
      </equation>
      We now have all the quantities necessary to compute our
      recursive estimator using the Gauss-Markov Theorem.
    </para>

    <para id="para10">We will now derive a recursion for conditional
      distribution of
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>y</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub>
	</m:ci>
      </m:math> given
      <m:math>
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:apply>
      </m:math> (best estimate based on past observations) and
      <m:math>
	<m:ci><m:msub>
	    <m:mi>x</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub></m:ci>
      </m:math> (current observation). We know that
      <m:math>
	<m:mrow>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	  <m:mo>|</m:mo>
	  <m:mi>(</m:mi>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:apply>
	  <m:mo>,</m:mo>
	  <m:ci><m:msub>
	      <m:mi>x</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	  <m:mi>)</m:mi>
	</m:mrow>
      </m:math> is Gaussian (since all quantities are jointly
      Gaussian). Let's denote this conditional distribution by
      <m:math display="block">
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	  <m:mrow>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:mo>|</m:mo>
	    <m:mi>(</m:mi>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:mo>,</m:mo>
	    <m:ci><m:msub>
		<m:mi>x</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:mi>)</m:mi>
	  </m:mrow>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>P</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	  </m:apply>
	</m:apply>
      </m:math> 
      Applying the Gauss-Markov Theorem we find
      <equation id="eqn27">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:apply>
	      <m:times/>
	      <m:apply>
		<m:transpose/>
		<m:vector>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>P</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		  <m:apply>
		    <m:times/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>R</m:mi>
			<m:mi>n</m:mi>
		      </m:msub>
		    </m:ci>
		    <m:ci type="vector">C</m:ci>
		  </m:apply>
		</m:vector>
	      </m:apply>
	      <m:apply>
		<m:inverse/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>S</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
	      </m:apply>
	      <m:vector>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:ci><m:msub>
		    <m:mi>x</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:vector>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      which is the best estimator of
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>y</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub>
	</m:ci>
      </m:math> given
      <m:math>
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>y</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:apply>
      </m:math> and
      <m:math>
	<m:ci><m:msub>
	    <m:mi>x</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub></m:ci>
      </m:math>. The inverse of
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>S</m:mi>
	    <m:mi>n</m:mi>
	  </m:msub>
	</m:ci>
      </m:math> is given by
      <equation id="eqn28">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:inverse/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>S</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:apply>
	      <m:plus/>
	      <m:matrix>
		<m:matrixrow>
		  <m:apply>
		    <m:inverse/>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>P</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		  </m:apply>
		  <m:ci type="vector">0</m:ci>
		</m:matrixrow>
		<m:matrixrow>
		  <m:ci type="vector">0</m:ci>
		  <m:ci type="vector">0</m:ci>
		</m:matrixrow>
	      </m:matrix>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:inverse/>
		  <m:ci><m:msub>
		      <m:mi>γ</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
		<m:vector>
		  <m:apply>
		    <m:minus/>
		    <m:ci type="vector">C</m:ci>
		  </m:apply>
		  <m:cn>1</m:cn>
		</m:vector>
		<m:apply>
		  <m:transpose/>
		  <m:vector>
		    <m:apply>
		      <m:minus/>
		      <m:apply>
			<m:transpose/>
			<m:ci type="vector">C</m:ci>
		      </m:apply>
		    </m:apply>
		    <m:cn>1</m:cn>
		  </m:vector>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      where
      <equation id="eqn29">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:inverse/>
	      <m:ci><m:msub>
		  <m:mi>γ</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	    </m:apply>
	    <m:apply>
	      <m:minus/>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
		<m:apply>
		  <m:minus/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>R</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:ci type="vector">C</m:ci>
	      </m:apply>
	    </m:apply>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
		<m:ci type="vector">C</m:ci>
	      </m:apply>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>w</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>

      <note type="Recall" id="idp6991408"><label>Recall</label>
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:power/>
	      <m:ci><m:msub>
		  <m:mi>σ</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	      <m:cn>2</m:cn>
	    </m:apply>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>R</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:ci type="vector">C</m:ci>
	      </m:apply>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>w</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </note>
      Substituting this inverse formula into <link target-id="eqn27"/> yields
      <equation id="eqn30">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	      <m:apply>
		<m:times/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
		<m:ci type="vector">C</m:ci>
		<m:apply>
		  <m:inverse/>
		  <m:ci><m:msub>
		      <m:mi>γ</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
		<m:apply>
		  <m:minus/>
		  <m:ci><m:msub>
		      <m:mi>x</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:transpose/>
		      <m:ci type="vector">C</m:ci>
		    </m:apply>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>y</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      The Gauss-Markov Theorem also gives us an expression for
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>P</m:mi>
	    <m:mrow>
	      <m:mi>n</m:mi>
	      <m:mo>|</m:mo>
	      <m:mi>n</m:mi>
	    </m:mrow>
	  </m:msub>
	</m:ci>
      </m:math>:
      <equation id="eqn31">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>P</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:minus/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>R</m:mi>
		  <m:mi>n</m:mi>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:transpose/>
		  <m:vector>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>P</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		    <m:apply>
		      <m:times/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>R</m:mi>
			  <m:mi>n</m:mi>
			</m:msub>
		      </m:ci>
		      <m:ci type="vector">C</m:ci>
		    </m:apply>
		  </m:vector>
		</m:apply>
		<m:apply>
		  <m:inverse/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>S</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		</m:apply>
		<m:vector>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>P</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:transpose/>
		      <m:ci type="vector">C</m:ci>
		    </m:apply>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>R</m:mi>
			<m:mi>n</m:mi>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		</m:vector>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      and upon substituting <link target-id="eqn27"/> for
      <m:math>
	<m:apply>
	  <m:inverse/>
	  <m:ci type="vector">
	    <m:msub>
	      <m:mi>S</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub>
	  </m:ci>
	</m:apply>
      </m:math> we get
      <equation id="eqn32">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>P</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:minus/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>P</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:inverse/>
		  <m:ci><m:msub>
		      <m:mi>γ</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
		<m:ci type="vector">C</m:ci>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">C</m:ci>
		</m:apply>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>

      Note that both expressions contain the quantity
      <equation id="eqn33">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>K</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:times/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>P</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	      <m:ci type="vector">C</m:ci>
	      <m:apply>
		<m:inverse/>
		<m:ci><m:msub>
		    <m:mi>γ</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      which is the so-called <term>Kalman gain</term>.
    </para>

    <para id="para11">Using the Kalman gain, the <term>Kalman
	recursions</term> are given by
      <equation id="eqn34">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	      <m:apply>
		<m:times/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>K</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:apply>
		  <m:minus/>
		  <m:ci><m:msub>
		      <m:mi>x</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:transpose/>
		      <m:ci type="vector">C</m:ci>
		    </m:apply>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>y</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>

      <equation id="eqn35">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>P</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:minus/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>P</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	      <m:apply>
		<m:times/>
		<m:ci><m:msub>
		    <m:mi>γ</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>K</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>K</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      The recursions are complete except for definitions of
      <m:math>
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	  <m:ci type="vector">
	    <m:msub>
	      <m:ci>y</m:ci>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>|</m:mo>
		<m:mi>n</m:mi>
		<m:mo>-</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub>
	  </m:ci>
	</m:apply>
      </m:math> and
      <m:math>
	<m:ci type="vector">
	  <m:msub>
	    <m:mi>P</m:mi>
	    <m:mrow>
	      <m:mi>n</m:mi>
	      <m:mo>|</m:mo>
	      <m:mi>n</m:mi>
	      <m:mo>-</m:mo>
	      <m:mn>1</m:mn>
	    </m:mrow>
	  </m:msub>
	</m:ci>
      </m:math>.
      <equation id="eqn36">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		    <m:mo>-</m:mo>
		    <m:mn>1</m:mn>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
	      <m:mrow>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub>
		</m:ci>
		<m:mo>|</m:mo>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>x</m:mi>
		    <m:apply>
		      <m:minus/>
		      <m:mi>n</m:mi>
		      <m:mn>1</m:mn>
		    </m:apply>
		  </m:msub>
		</m:ci>
	      </m:mrow>
	    </m:apply>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
	      <m:mrow>
		<m:apply>
		  <m:plus/>
		  <m:apply>
		    <m:times/>
		    <m:ci type="vector">A</m:ci>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:apply>
			  <m:minus/>
			  <m:mi>n</m:mi>
			  <m:mn>1</m:mn>
			</m:apply>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		  <m:apply>
		    <m:times/>
		    <m:ci type="vector">b</m:ci>
		    <m:ci><m:msub>
			<m:mi>u</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub></m:ci>
		  </m:apply>
		</m:apply>
		<m:mo>|</m:mo>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>x</m:mi>
		    <m:apply>
		      <m:minus/>
		      <m:mi>n</m:mi>
		      <m:mn>1</m:mn>
		    </m:apply>
		  </m:msub>
		</m:ci>
	      </m:mrow>
	    </m:apply>

	    <m:apply>
	      <m:times/>
	      <m:ci type="vector">A</m:ci>
	      <m:apply>
		<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>y</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>

      <equation id="eqn37">
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>P</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>|</m:mo>
		  <m:mi>n</m:mi>
		  <m:mo>-</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub>
	    </m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#expectedvalue"/>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:minus/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub>
		  </m:ci>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub>
		    </m:ci>
		  </m:apply>
		</m:apply>
		<m:apply>
		  <m:transpose/>
		  <m:apply>
		    <m:minus/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mi>n</m:mi>
		      </m:msub>
		    </m:ci>
		    <m:apply>
		      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		      <m:ci type="vector">
			<m:msub>
			  <m:mi>y</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub>
		      </m:ci>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:apply>

	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:ci type="vector">A</m:ci>
		<m:ci type="vector">
		  <m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub>
		</m:ci>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">A</m:ci>
		</m:apply>
	      </m:apply>
	      <m:apply>
		<m:times/>
		<m:apply>
		  <m:power/>
		  <m:ci><m:msub>
		      <m:mi>σ</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		  <m:cn>2</m:cn>
		</m:apply>
		<m:ci type="vector">b</m:ci>
		<m:apply>
		  <m:transpose/>
		  <m:ci type="vector">b</m:ci>
		</m:apply>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>
      </equation>
      Now we can summarize the <term>Kalman filter</term>:

      <list id="list1" list-type="enumerated">
	<item><link target-id="eqn34"/>, where
	  <m:math>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
	      <m:ci type="vector">
		<m:msub>
		  <m:mi>y</m:mi>
		  <m:mrow>
		    <m:mi>n</m:mi>
		    <m:mo>|</m:mo>
		    <m:mi>n</m:mi>
		  </m:mrow>
		</m:msub>
	      </m:ci>
	    </m:apply>
	  </m:math> is the best estimate if
	  <m:math>
	    <m:ci type="vector">
	      <m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub>
	    </m:ci>
	  </m:math> given observations up to time
	  <m:math><m:ci>n</m:ci></m:math>.
	</item>

	<item><link target-id="eqn36"/></item>

	<item><link target-id="eqn33"/></item>

	<item><link target-id="eqn29"/></item>

	<item><link target-id="eqn35"/></item>

	<item><link target-id="eqn37"/></item>
      </list>
    </para>

    <para id="para12">Measurements/observation model:
      <m:math display="block">
	<m:apply>
	  <m:eq/>
	  <m:ci><m:msub>
	      <m:mi>x</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	  <m:apply>
	    <m:plus/>
	    <m:ci><m:msub>
		<m:mi>y</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:ci><m:msub>
		<m:mi>w</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	  </m:apply>
	</m:apply>
      </m:math>

      <m:math display="block">
	<m:apply>
	  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	  <m:ci><m:msub>
	      <m:mi>w</m:mi>
	      <m:mi>n</m:mi>
	    </m:msub></m:ci>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	    <m:cn>0</m:cn>
	    <m:apply>
	      <m:power/>
	      <m:ci><m:msub>
		  <m:mi>σ</m:mi>
		  <m:mi>w</m:mi>
		</m:msub></m:ci>
	      <m:cn>2</m:cn>
	    </m:apply>
	  </m:apply>
	</m:apply>
      </m:math>
      (<m:math>
	<m:apply>
	  <m:eq/>
	  <m:ci type="vector">C</m:ci>
	  <m:cn>1</m:cn>
	</m:apply>
      </m:math>).

    </para>

    <example id="ex1">
      <title>First-order Gauss-Markov Process</title>
      <para id="para1.1">
	<m:math display="block">
	  <m:apply>
	    <m:eq/>
	    <m:ci><m:msub>
		<m:mi>y</m:mi>
		<m:mrow>
		  <m:mi>n</m:mi>
		  <m:mo>+</m:mo>
		  <m:mn>1</m:mn>
		</m:mrow>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:plus/>
	      <m:apply>
		<m:times/>
		<m:ci>a</m:ci>
		<m:ci><m:msub>
		    <m:mi>y</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
	      </m:apply>
	      <m:ci><m:msub>
		  <m:mi>u</m:mi>
		  <m:mi>n</m:mi>
		</m:msub></m:ci>
	    </m:apply>
	  </m:apply>
	</m:math> 
	Where
	<m:math>
	  <m:ci><m:msub>
	      <m:mi>y</m:mi>
	      <m:mrow>
		<m:mi>n</m:mi>
		<m:mo>+</m:mo>
		<m:mn>1</m:mn>
	      </m:mrow>
	    </m:msub></m:ci>
	</m:math> is a time-varying voltage, 
	<m:math>
	  <m:apply>
	    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#distributedin"/>
	    <m:ci><m:msub>
		<m:mi>u</m:mi>
		<m:mi>n</m:mi>
	      </m:msub></m:ci>
	    <m:apply>
	      <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#normaldistribution"/>
	      <m:cn>0</m:cn>
	      <m:apply>
		<m:power/>
		<m:ci><m:msub>
		    <m:mi>σ</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:cn>2</m:cn>
	      </m:apply>
	    </m:apply>
	  </m:apply>
	</m:math>, and
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci><m:msub>
		<m:mi>σ</m:mi>
		<m:mi>u</m:mi>
	      </m:msub></m:ci>
	    <m:cn>0.1</m:cn>
	  </m:apply>
	</m:math>.
	<m:math>
	  <m:apply>
	    <m:implies/>
	    <m:apply>
	      <m:eq/>
	      <m:ci>a</m:ci>
	      <m:cn>0.99</m:cn>
	    </m:apply>
	    <m:mtext>highly correlated process</m:mtext>
	  </m:apply>
	</m:math>. (<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">A</m:ci>
	    <m:ci>a</m:ci>
	  </m:apply>
	</m:math>, 
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:ci type="vector">b</m:ci>
	    <m:cn>1</m:cn>
	  </m:apply>
	</m:math>).

	<figure id="fig6">   
	  <media id="idp9254944" alt=""><image src="../../media/sig_obs.png" mime-type="image/png"/></media>
	</figure>

	<list id="list2" list-type="enumerated">
	  <title>Kalman Filtering Equations</title>

	  <item>
	    <m:math>
	      <m:apply>
		<m:eq/>
		<m:ci><m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		      <m:mo>-</m:mo>
		      <m:mn>1</m:mn>
		    </m:mrow>
		  </m:msub></m:ci>
		
		<m:apply>
		  <m:plus/>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:power/>
		      <m:ci>a</m:ci>
		      <m:cn>2</m:cn>
		    </m:apply>
		    <m:ci><m:msub>
			<m:mi>P</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub></m:ci>
		  </m:apply>
		  <m:apply>
		    <m:power/>
		    <m:ci><m:msub>
			<m:mi>σ</m:mi>
			<m:mi>n</m:mi>
		      </m:msub></m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:math>
	    (<m:math>
	      <m:apply>
		<m:ci type="fn">q</m:ci>
		<m:ci>n</m:ci>
	      </m:apply>
	    </m:math> in MATLAB code)
	  </item>

	  <item>
	    <m:math>
	      <m:apply>
		<m:eq/>
		<m:apply>
		  <m:inverse/>
		  <m:ci><m:msub>
		      <m:mi>γ</m:mi>
		      <m:mi>n</m:mi>
		    </m:msub></m:ci>
		</m:apply>
		<m:apply>
		  <m:plus/>
		  <m:ci><m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub></m:ci>
		  <m:apply>
		    <m:power/>
		    <m:ci><m:msub>
			<m:mi>σ</m:mi>
			<m:mi>w</m:mi>
		      </m:msub></m:ci>
		    <m:cn>2</m:cn>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:math>
	    (<m:math>
	      <m:apply>
		<m:ci type="fn">g</m:ci>
		<m:ci>n</m:ci>
	      </m:apply>
	    </m:math> in MATLAB code)
	  </item>

	  <item>
	    <m:math>
	      <m:apply>
		<m:eq/>
		<m:ci><m:msub>
		    <m:mi>P</m:mi>
		    <m:mrow>
		      <m:mi>n</m:mi>
		      <m:mo>|</m:mo>
		      <m:mi>n</m:mi>
		    </m:mrow>
		  </m:msub></m:ci>
		<m:apply>
		  <m:minus/>
		  <m:ci><m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub></m:ci>
		  <m:apply>
		    <m:times/>
		    <m:apply>
		      <m:inverse/>
		      <m:ci><m:msub>
			  <m:mi>γ</m:mi>
			  <m:mi>n</m:mi>
			</m:msub></m:ci>
		    </m:apply>
		    <m:apply>
		      <m:power/>
		      <m:ci><m:msub>
			  <m:mi>P</m:mi>
			  <m:mrow>
			    <m:mi>n</m:mi>
			    <m:mo>|</m:mo>
			    <m:mi>n</m:mi>
			    <m:mo>-</m:mo>
			    <m:mn>1</m:mn>
			  </m:mrow>
			</m:msub></m:ci>
		      <m:cn>2</m:cn>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:math>
	    (<m:math>
	      <m:apply>
		<m:ci type="fn">p</m:ci>
		<m:ci>n</m:ci>
	      </m:apply>
	    </m:math> in MATLAB code)
	  </item>

	  <item>
	    <m:math>
	      <m:apply>
		<m:eq/>
		<m:ci><m:msub>
		    <m:mi>K</m:mi>
		    <m:mi>n</m:mi>
		  </m:msub></m:ci>
		<m:apply>
		  <m:times/>
		  <m:ci><m:msub>
		      <m:mi>P</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub></m:ci>
		  <m:apply>
		    <m:inverse/>
		    <m:ci><m:msub>
			<m:mi>γ</m:mi>
			<m:mi>n</m:mi>
		      </m:msub></m:ci>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:math>
	    (<m:math>
	      <m:apply>
		<m:ci type="fn">k</m:ci>
		<m:ci>n</m:ci>
	      </m:apply>
	    </m:math> in MATLAB code)
	  </item>

	  <item>
	    <m:math>
	      <m:apply>
		<m:eq/>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
			<m:mo>-</m:mo>
			<m:mn>1</m:mn>
		      </m:mrow>
		    </m:msub></m:ci>
		</m:apply>

		<m:apply>
		  <m:times/>
		  <m:ci>a</m:ci>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
		      </m:mrow>
		      </m:msub></m:ci>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:math>
	    (<m:math>
	      <m:apply>
		<m:ci type="fn">py</m:ci>
		<m:ci>n</m:ci>
	      </m:apply>
	    </m:math> in MATLAB code)
	  </item>
	  
	  <item>
	    <m:math>
	      <m:apply>
		<m:eq/>
		<m:apply>
		  <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		  <m:ci type="vector">
		    <m:msub>
		      <m:mi>y</m:mi>
		      <m:mrow>
			<m:mi>n</m:mi>
			<m:mo>|</m:mo>
			<m:mi>n</m:mi>
		      </m:mrow>
		    </m:msub></m:ci>
		</m:apply>
		<m:apply>
		  <m:plus/>
		  <m:apply>
		    <m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
		    <m:ci type="vector">
		      <m:msub>
			<m:mi>y</m:mi>
			<m:mrow>
			  <m:mi>n</m:mi>
			  <m:mo>|</m:mo>
			  <m:mi>n</m:mi>
			  <m:mo>-</m:mo>
			  <m:mn>1</m:mn>
			</m:mrow>
		      </m:msub></m:ci>
		  </m:apply>
		  <m:apply>
		    <m:times/>
		    <m:ci><m:msub>
			<m:mi>K</m:mi>
			<m:mi>n</m:mi>
		      </m:msub></m:ci>
		    <m:apply>
		      <m:minus/>
		      <m:ci><m:msub>
			  <m:mi>x</m:mi>
			  <m:mi>n</m:mi>
			</m:msub></m:ci>
		      <m:apply>
			<m:csymbol definitionURL="http://cnx.rice.edu/cd/cnxmath.ocd#estimate"/>
			<m:ci type="vector">
			  <m:msub>
			    <m:mi>y</m:mi>
			    <m:mrow>
			      <m:mi>n</m:mi>
			      <m:mo>|</m:mo>
			      <m:mi>n</m:mi>
			      <m:mo>-</m:mo>
			      <m:mn>1</m:mn>
			    </m:mrow>
			  </m:msub></m:ci>
		      </m:apply>
		    </m:apply>
		  </m:apply>
		</m:apply>
	      </m:apply>
	    </m:math>
	    (<m:math>
	      <m:apply>
		<m:ci type="fn">ey</m:ci>
		<m:ci>n</m:ci>
	      </m:apply>
	    </m:math> in MATLAB code)
	  </item>
	</list>
	
	Initialization:
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:ci type="fn">ey</m:ci>
	      <m:cn>1</m:cn>
	    </m:apply>
	    <m:cn>0</m:cn>
	  </m:apply>
	</m:math>,
	<m:math>
	  <m:apply>
	    <m:eq/>
	    <m:apply>
	      <m:ci type="fn">q</m:ci>
	      <m:cn>1</m:cn>
	    </m:apply>
	    <m:apply>
	      <m:power/>
	      <m:ci><m:msub>
		  <m:mi>σ</m:mi>
		  <m:mi>u</m:mi>
		</m:msub></m:ci>
	      <m:cn>2</m:cn>
	    </m:apply>
	  </m:apply>
	</m:math>

	<figure id="fig7">   
	  <media id="idp8986176" alt=""><image src="../../media/sig_obs_filter.png" mime-type="image/png"/></media>
	</figure>
	
      </para>
    </example>

  </content> 

</document>